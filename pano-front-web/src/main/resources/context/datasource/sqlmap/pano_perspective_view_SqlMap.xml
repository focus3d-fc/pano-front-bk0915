<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="pano_perspective_view">
  <resultMap class="com.focus3d.pano.model.ibator.PanoPerspectiveView" id="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    <result column="SN" jdbcType="BIGINT" property="sn" />
    <result column="VIEW_NAME" jdbcType="VARCHAR" property="viewName" />
    <result column="BASE_MAP" jdbcType="BIGINT" property="baseMap" />
    <result column="HOUSE_STYLE_SN" jdbcType="BIGINT" property="houseStyleSn" />
    <result column="HOUSE_SPACE_SN" jdbcType="BIGINT" property="houseSpaceSn" />
    <result column="ADDER_SN" jdbcType="BIGINT" property="adderSn" />
    <result column="ADDER_NAME" jdbcType="VARCHAR" property="adderName" />
    <result column="ADD_TIME" jdbcType="TIMESTAMP" property="addTime" />
    <result column="UPDATER_SN" jdbcType="BIGINT" property="updaterSn" />
    <result column="UPDATER_NAME" jdbcType="VARCHAR" property="updaterName" />
    <result column="UPDATE_TIME" jdbcType="TIMESTAMP" property="updateTime" />
    <result column="VIEW_ORDER" jdbcType="INTEGER" property="viewOrder" />
  </resultMap>
  <sql id="ibatorgenerated_Example_Where_Clause">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    <iterate conjunction="or" prepend="where" property="oredCriteria" removeFirstPrepend="iterate">
      <isEqual compareValue="true" property="oredCriteria[].valid">
        (
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithoutValue">
          $oredCriteria[].criteriaWithoutValue[]$
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithSingleValue">
          $oredCriteria[].criteriaWithSingleValue[].condition$
            #oredCriteria[].criteriaWithSingleValue[].value#
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithListValue">
          $oredCriteria[].criteriaWithListValue[].condition$
          <iterate close=")" conjunction="," open="(" property="oredCriteria[].criteriaWithListValue[].values">
            #oredCriteria[].criteriaWithListValue[].values[]#
          </iterate>
        </iterate>
        <iterate conjunction="and" prepend="and" property="oredCriteria[].criteriaWithBetweenValue">
          $oredCriteria[].criteriaWithBetweenValue[].condition$
          #oredCriteria[].criteriaWithBetweenValue[].values[0]# and
          #oredCriteria[].criteriaWithBetweenValue[].values[1]#
        </iterate>
        )
      </isEqual>
    </iterate>
  </sql>
  <select id="ibatorgenerated_selectByExample" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveViewCriteria" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    select SN, VIEW_NAME, BASE_MAP, HOUSE_STYLE_SN, HOUSE_SPACE_SN, ADDER_SN, ADDER_NAME, ADD_TIME,
      UPDATER_SN, UPDATER_NAME, UPDATE_TIME, VIEW_ORDER
    from pano_perspective_view
    <isParameterPresent>
      <include refid="pano_perspective_view.ibatorgenerated_Example_Where_Clause" />
      <isNotNull property="orderByClause">
        order by $orderByClause$
      </isNotNull>
    </isParameterPresent>
  </select>
  <select id="ibatorgenerated_selectByPrimaryKey" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveView" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    select SN, VIEW_NAME, BASE_MAP, HOUSE_STYLE_SN, HOUSE_SPACE_SN, ADDER_SN, ADDER_NAME, ADD_TIME,
      UPDATER_SN, UPDATER_NAME, UPDATE_TIME, VIEW_ORDER
    from pano_perspective_view
    where SN = #sn:BIGINT#
  </select>
  <delete id="ibatorgenerated_deleteByPrimaryKey" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveView">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    delete from pano_perspective_view
    where SN = #sn:BIGINT#
  </delete>
  <delete id="ibatorgenerated_deleteByExample" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveViewCriteria">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    delete from pano_perspective_view
    <include refid="pano_perspective_view.ibatorgenerated_Example_Where_Clause" />
  </delete>
  <insert id="ibatorgenerated_insert" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveView">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    insert into pano_perspective_view (VIEW_NAME, BASE_MAP, HOUSE_STYLE_SN, HOUSE_SPACE_SN,
      ADDER_SN, ADDER_NAME, ADD_TIME, UPDATER_SN, UPDATER_NAME, UPDATE_TIME, VIEW_ORDER)
    values (#viewName:VARCHAR#, #baseMap:BIGINT#, #houseStyleSn:BIGINT#, #houseSpaceSn:BIGINT#,
      #adderSn:BIGINT#, #adderName:VARCHAR#, #addTime:TIMESTAMP#, #updaterSn:BIGINT#,
      #updaterName:VARCHAR#, #updateTime:TIMESTAMP#, #viewOrder:INTEGER#)
    <selectKey keyProperty="sn" resultClass="java.lang.Long">
      select last_insert_id()
    </selectKey>
  </insert>
  <insert id="ibatorgenerated_insertSelective" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveView">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    insert into pano_perspective_view
    <dynamic prepend="(">
      <isNotNull prepend="," property="viewName">
        VIEW_NAME
      </isNotNull>
      <isNotNull prepend="," property="baseMap">
        BASE_MAP
      </isNotNull>
      <isNotNull prepend="," property="houseStyleSn">
        HOUSE_STYLE_SN
      </isNotNull>
      <isNotNull prepend="," property="houseSpaceSn">
        HOUSE_SPACE_SN
      </isNotNull>
      <isNotNull prepend="," property="adderSn">
        ADDER_SN
      </isNotNull>
      <isNotNull prepend="," property="adderName">
        ADDER_NAME
      </isNotNull>
      <isNotNull prepend="," property="addTime">
        ADD_TIME
      </isNotNull>
      <isNotNull prepend="," property="updaterSn">
        UPDATER_SN
      </isNotNull>
      <isNotNull prepend="," property="updaterName">
        UPDATER_NAME
      </isNotNull>
      <isNotNull prepend="," property="updateTime">
        UPDATE_TIME
      </isNotNull>
      <isNotNull prepend="," property="viewOrder">
        VIEW_ORDER
      </isNotNull>
      )
    </dynamic>
    values
    <dynamic prepend="(">
      <isNotNull prepend="," property="viewName">
        #viewName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="baseMap">
        #baseMap:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="houseStyleSn">
        #houseStyleSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="houseSpaceSn">
        #houseSpaceSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="adderSn">
        #adderSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="adderName">
        #adderName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="addTime">
        #addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="updaterSn">
        #updaterSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="updaterName">
        #updaterName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="updateTime">
        #updateTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="viewOrder">
        #viewOrder:INTEGER#
      </isNotNull>
      )
    </dynamic>
    <selectKey keyProperty="sn" resultClass="java.lang.Long">
      select last_insert_id()
    </selectKey>
  </insert>
  <select id="ibatorgenerated_countByExample" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveViewCriteria" resultClass="java.lang.Integer">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    select count(*) from pano_perspective_view
    <include refid="pano_perspective_view.ibatorgenerated_Example_Where_Clause" />
  </select>
  <update id="ibatorgenerated_updateByExampleSelective">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    update pano_perspective_view
    <dynamic prepend="set">
      <isNotNull prepend="," property="record.sn">
        SN = #record.sn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="record.viewName">
        VIEW_NAME = #record.viewName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.baseMap">
        BASE_MAP = #record.baseMap:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="record.houseStyleSn">
        HOUSE_STYLE_SN = #record.houseStyleSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="record.houseSpaceSn">
        HOUSE_SPACE_SN = #record.houseSpaceSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="record.adderSn">
        ADDER_SN = #record.adderSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="record.adderName">
        ADDER_NAME = #record.adderName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.addTime">
        ADD_TIME = #record.addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="record.updaterSn">
        UPDATER_SN = #record.updaterSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="record.updaterName">
        UPDATER_NAME = #record.updaterName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="record.updateTime">
        UPDATE_TIME = #record.updateTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="record.viewOrder">
        VIEW_ORDER = #record.viewOrder:INTEGER#
      </isNotNull>
    </dynamic>
    <isParameterPresent>
      <include refid="pano_perspective_view.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByExample">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    update pano_perspective_view
    set SN = #record.sn:BIGINT#,
      VIEW_NAME = #record.viewName:VARCHAR#,
      BASE_MAP = #record.baseMap:BIGINT#,
      HOUSE_STYLE_SN = #record.houseStyleSn:BIGINT#,
      HOUSE_SPACE_SN = #record.houseSpaceSn:BIGINT#,
      ADDER_SN = #record.adderSn:BIGINT#,
      ADDER_NAME = #record.adderName:VARCHAR#,
      ADD_TIME = #record.addTime:TIMESTAMP#,
      UPDATER_SN = #record.updaterSn:BIGINT#,
      UPDATER_NAME = #record.updaterName:VARCHAR#,
      UPDATE_TIME = #record.updateTime:TIMESTAMP#,
      VIEW_ORDER = #record.viewOrder:INTEGER#
    <isParameterPresent>
      <include refid="pano_perspective_view.ibatorgenerated_Example_Where_Clause" />
    </isParameterPresent>
  </update>
  <update id="ibatorgenerated_updateByPrimaryKeySelective" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveView">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    update pano_perspective_view
    <dynamic prepend="set">
      <isNotNull prepend="," property="viewName">
        VIEW_NAME = #viewName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="baseMap">
        BASE_MAP = #baseMap:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="houseStyleSn">
        HOUSE_STYLE_SN = #houseStyleSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="houseSpaceSn">
        HOUSE_SPACE_SN = #houseSpaceSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="adderSn">
        ADDER_SN = #adderSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="adderName">
        ADDER_NAME = #adderName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="addTime">
        ADD_TIME = #addTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="updaterSn">
        UPDATER_SN = #updaterSn:BIGINT#
      </isNotNull>
      <isNotNull prepend="," property="updaterName">
        UPDATER_NAME = #updaterName:VARCHAR#
      </isNotNull>
      <isNotNull prepend="," property="updateTime">
        UPDATE_TIME = #updateTime:TIMESTAMP#
      </isNotNull>
      <isNotNull prepend="," property="viewOrder">
        VIEW_ORDER = #viewOrder:INTEGER#
      </isNotNull>
    </dynamic>
    where SN = #sn:BIGINT#
  </update>
  <update id="ibatorgenerated_updateByPrimaryKey" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveView">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    update pano_perspective_view
    set VIEW_NAME = #viewName:VARCHAR#,
      BASE_MAP = #baseMap:BIGINT#,
      HOUSE_STYLE_SN = #houseStyleSn:BIGINT#,
      HOUSE_SPACE_SN = #houseSpaceSn:BIGINT#,
      ADDER_SN = #adderSn:BIGINT#,
      ADDER_NAME = #adderName:VARCHAR#,
      ADD_TIME = #addTime:TIMESTAMP#,
      UPDATER_SN = #updaterSn:BIGINT#,
      UPDATER_NAME = #updaterName:VARCHAR#,
      UPDATE_TIME = #updateTime:TIMESTAMP#,
      VIEW_ORDER = #viewOrder:INTEGER#
    where SN = #sn:BIGINT#
  </update>
  <select id="ibatorgenerated_selectListRecord" parameterClass="com.focustech.cief.ibatis.domain.PageInfo" resultMap="ibatorgenerated_BaseResultMap">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    <![CDATA[select SN, VIEW_NAME, BASE_MAP, HOUSE_STYLE_SN, HOUSE_SPACE_SN, ADDER_SN, ADDER_NAME,
      ADD_TIME, UPDATER_SN, UPDATER_NAME, UPDATE_TIME, VIEW_ORDER
    from pano_perspective_view limit #startRecord#,#perPageInt#]]>
  </select>
  <select id="ibatorgenerated_selectListCount" parameterClass="com.focustech.cief.ibatis.domain.PageInfo" resultClass="java.lang.Integer">
    <!--
      WARNING - This element is automatically generated by Apache iBATIS ibator, do not modify.
      This element was generated on Sun Aug 20 22:36:51 CST 2017.
    -->
    <![CDATA[select count(*) from pano_perspective_view]]>
  </select>

	<select id="view_all_products" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveView" resultClass="java.util.LinkedHashMap">
	    SELECT 
	      space.sn AS spaceId,
	      space.name AS spaceName,
	      view.`SN` AS viewId,
	      View.`VIEW_NAME` AS viewName,
	      view.`BASE_MAP` AS viewMap,
	      layer.`SN` AS layerId,
	      layer.`LAYER_NAME` AS layerName,
	      layer.`LAYER_ORDER` AS layerOrder,
	      element.`SN` AS elementId,
	      element.`ELEMENT_ORDER` AS elementOrder,
	      elementProduct.product_map AS elementMap,
	      elementProduct.`position` AS position,
	      elementProduct.`scale` AS scale,
	      elementProduct.`repeating` AS repeating,
	      elementName, 
	      element.package_type_sn AS elementStyleId
	    FROM
	      pano_perspective_view view
	      INNER JOIN pano_project_space space
	      ON space.sn = view.house_space_sn
	      LEFT JOIN pano_perspective_layer layer
	        ON view.`SN` = layer.view_sn 
	      LEFT JOIN (SELECT _element.*,type.`NAME` AS elementName FROM pano_perspective_element _element INNER JOIN pano_project_package_type TYPE ON _element.package_type_sn = type.sn) AS element
	        ON layer.`SN` = element.`LAYER_SN`
	      LEFT JOIN (SELECT _elementProduct.* FROM pano_perspective_element_product _elementProduct INNER JOIN pano_product product ON _elementProduct.product_sn = product.sn) AS elementProduct
		ON element.element_product_sn = elementProduct.sn
		where view.`HOUSE_STYLE_SN` = #houseStyleSn#
		ORDER BY layerOrder ASC,elementOrder ASC
	</select>
	
	<!--  select id="query_perspective" parameterClass="java.util.HashMap" resultClass="java.util.LinkedHashMap">
		SELECT 
		  space.sn AS spaceId,
		  space.name AS spaceName,
		  view.`SN` AS viewId,
		  View.`VIEW_NAME` AS viewName,
		  view.`BASE_MAP` AS viewMap,
		  layer.`SN` AS layerId,
		  layer.`LAYER_NAME` AS layerName,
		  layer.`LAYER_ORDER` AS layerOrder,
		  element.`SN` AS elementId,
		  element.`ELEMENT_ORDER` AS elementOrder,
		  elementName,
		  element.package_type_sn AS elementStyleId,
		  shop_cart.productId AS productId,
		  shop_cart.elementMap AS elementMap,
		  shop_cart.position AS position,
		  shop_cart.scale AS scale,
		  shop_cart.repeating AS repeating
		FROM
		  pano_perspective_view VIEW 
		  INNER JOIN pano_project_space SPACE
		    ON space.sn = view.house_space_sn 
		  LEFT JOIN pano_perspective_layer layer 
		    ON view.`SN` = layer.view_sn 
		  LEFT JOIN  (SELECT _element.*,type.`NAME` AS elementName FROM pano_perspective_element _element INNER JOIN pano_project_package_type TYPE ON _element.package_type_sn = type.sn) AS element 
		    ON layer.`SN` = element.`LAYER_SN` 
		  LEFT JOIN ( SELECT element.sn AS elementId,cart_detail.package_product_sn AS productId,elementProduct.product_map AS elementMap, elementProduct.`position` AS position,elementProduct.`scale` AS scale,elementProduct.`repeating` AS repeating,cart_detail.package_type_sn,cart_detail.package_product_sn AS product_sn FROM pano_order_shopcart cart INNER JOIN pano_order_shopcart_detail cart_detail ON cart_detail.shopcart_sn = cart.sn INNER JOIN pano_perspective_element element ON element.package_type_sn = cart_detail.package_type_sn INNER JOIN pano_perspective_element_product elementProduct ON elementProduct.element_sn = element.sn AND elementProduct.product_sn = cart_detail.package_product_sn INNER JOIN pano_product product ON elementProduct.product_sn = product.sn WHERE cart.user_sn = #USER_SN#) AS shop_cart 
		    ON shop_cart.elementId = element.`SN`
		WHERE view.`HOUSE_STYLE_SN` = #HOUSE_STYLE_SN# 
		ORDER BY layerOrder ASC,elementOrder ASC 
	</select-->
	
	<select id="query_relation" parameterClass="java.util.HashMap" resultClass="java.util.LinkedHashMap">
		SELECT 
		  space.sn AS spaceId,
		  space.name AS spaceName,
		  view.`SN` AS viewId,
		  View.`VIEW_NAME` AS viewName
		FROM
		  pano_perspective_view VIEW 
		INNER JOIN pano_project_space SPACE
		  ON space.sn = view.house_space_sn
		WHERE view.`HOUSE_STYLE_SN` = #HOUSE_STYLE_SN# 
	</select>
	
	<select id="query_perspective" parameterClass="java.util.HashMap" resultClass="java.util.LinkedHashMap">
		SELECT 
		  view.`SN` AS viewId,
		  View.`VIEW_NAME` AS viewName,
		  view.`BASE_MAP` AS viewMap,
		  layer.`SN` AS layerId,
		  layer.`LAYER_NAME` AS layerName,
		  layer.`LAYER_ORDER` AS layerOrder,
		  element.`SN` AS elementId,
		  element.`ELEMENT_ORDER` AS elementOrder,
		  elementName,
		  element.package_type_sn AS elementStyleId,
		  shop_cart.productId AS productId,
		  shop_cart.elementMap AS elementMap,
		  shop_cart.position AS position,
		  shop_cart.scale AS scale,
		  shop_cart.repeating AS repeating
		FROM
		  pano_perspective_view VIEW 
		  LEFT JOIN pano_perspective_layer layer 
		    ON view.`SN` = layer.view_sn 
		  LEFT JOIN  (SELECT _element.*,type.`NAME` AS elementName FROM pano_perspective_element _element INNER JOIN pano_project_package_type TYPE ON _element.package_type_sn = type.sn) AS element 
		    ON layer.`SN` = element.`LAYER_SN` 
		  LEFT JOIN ( SELECT element.sn AS elementId,cart_detail.package_product_sn AS productId,elementProduct.product_map AS elementMap, elementProduct.`position` AS position,elementProduct.`scale` AS scale,elementProduct.`repeating` AS repeating,cart_detail.package_type_sn,cart_detail.package_product_sn AS product_sn FROM pano_order_shopcart cart INNER JOIN pano_order_shopcart_detail cart_detail ON cart_detail.shopcart_sn = cart.sn INNER JOIN pano_perspective_element element ON element.package_type_sn = cart_detail.package_type_sn INNER JOIN pano_perspective_element_product elementProduct ON elementProduct.element_sn = element.sn AND elementProduct.product_sn = cart_detail.package_product_sn INNER JOIN pano_product product ON elementProduct.product_sn = product.sn WHERE cart.user_sn = #USER_SN#) AS shop_cart 
		    ON shop_cart.elementId = element.`SN`
		WHERE view.`HOUSE_STYLE_SN` = #HOUSE_STYLE_SN# 
			AND view.sn = #VIEW_SN#
		ORDER BY layerOrder ASC,elementOrder ASC 
	</select>
	
	<select id="query_product_view" parameterClass="java.util.HashMap" resultClass="java.util.LinkedHashMap">
		SELECT 
          view.sn AS viewId,
          element.sn AS elementId 
        FROM
          pano_perspective_view VIEW 
          INNER JOIN pano_perspective_layer layer 
            ON view.`SN` = layer.view_sn 
          INNER JOIN pano_perspective_element element 
            ON layer.sn = element.layer_sn 
            AND element.package_type_sn = 10170 
        WHERE view.`HOUSE_STYLE_SN` = #HOUSE_STYLE_SN#
	</select>
	
	
	<update id="update_shopcart" parameterClass="java.util.HashMap">
		UPDATE 
        	pano_order_shopcart_detail cart_detail 
        INNER JOIN pano_order_shopcart cart 
          ON cart.sn = cart_detail.shopcart_sn 
          AND cart.user_sn = #user_sn# 
        INNER JOIN pano_perspective_element element 
          ON element.package_type_sn = cart_detail.package_type_sn AND element.sn = #element_sn#
        SET cart_detail.package_product_sn = #product_sn# 
	</update>
	
 	<select id="view_layer_element" parameterClass="java.lang.Long" resultClass="java.util.LinkedHashMap">
 		SELECT 
      view.`SN` AS viewId,
      View.`VIEW_NAME` AS viewName,
      view.`BASE_MAP` AS viewMap,
      layer.`SN` AS layerId,
      layer.`LAYER_NAME` AS layerName,
      layer.`LAYER_ORDER` AS layerOrder,
      element.`SN` AS elementId,
      element.`ELEMENT_ORDER` AS elementOrder,
      type.`NAME` AS elementName,
      element.package_type_sn AS elementStyleId 
    FROM
      pano_perspective_view VIEW
      LEFT JOIN pano_perspective_layer layer 
        ON view.`SN` = layer.view_sn
      LEFT JOIN pano_perspective_element element
        ON layer.`SN` = element.`LAYER_SN`
      LEFT JOIN pano_project_package_type TYPE 
        ON element.package_type_sn = type.sn
    WHERE view.`SN` = #sn#
    ORDER BY layerOrder ASC,elementOrder ASC
 	</select>
  
  	<select id="query_package_type" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveView" resultClass="java.util.HashMap">
      SELECT 
	    packageType.sn AS id,
	    packageType.name AS name 
	  FROM
	    pano_project_house_package package 
	    LEFT JOIN pano_project_package_type packageType 
	      ON package.sn = packageType.house_package_sn 
	  WHERE packageType.space_sn = #houseSpaceSn# 
	    AND package.house_style_sn = #houseStyleSn#
  	</select>
  	
  	<select id="query_used_package_type" parameterClass="java.lang.Long" resultClass="java.lang.String">
  	    SELECT 
	      element.package_type_sn AS packageTypeSn
	    FROM
	      pano_perspective_view VIEW 
	      INNER JOIN pano_perspective_layer layer 
	        ON layer.view_sn = view.sn 
	      INNER JOIN pano_perspective_element element 
	        ON element.layer_sn = layer.sn 
	    WHERE view.sn = #sn#
  	</select>
  
  	<delete id="delete_view" parameterClass="com.focus3d.pano.model.ibator.PanoPerspectiveViewModel">
	    DELETE 
	  		VIEW.*,
	  		layer.*,
	  		element.*,
	  		elementProduct.* 
		FROM
	  	pano_perspective_view VIEW 
	  		LEFT JOIN pano_perspective_layer layer 
	    ON layer.view_sn = view.sn 
	  		LEFT JOIN pano_perspective_element element 
	    ON element.`LAYER_SN` = layer.sn 
	  		LEFT JOIN pano_perspective_element_product elementProduct 
	    ON element.sn = elementProduct.`ELEMENT_SN` 
	  	WHERE view.sn = #sn#
  	</delete>
</sqlMap>